/* brief.js | Copyright 2014 Jeffrey E. Shaver II | Released under the MIT license | https://github.com/jeffshaver/brief.js/blob/master/LICENSE */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=global.document?e():function(){throw new Error("brief requires a document to run")}:t.brief=e()}(this,function(t,e,n){"use strict";var r,o={},l={},i={},s=n.prototype,c=e.prototype,a=s.slice,u=s.forEach,f=s.map,p=s.splice,h=s.push,g=s.pop,y=s.filter,m=c.matchesSelector||c.msMatchesSelector||c.mozMatchesSelector||c.webkitMatchesSelector||c.oMatchesSelector,d=/^#[\w\d]+$/,v=/^\.[\w\d]+$/,b=/^[\w\d]+$/,A=function(t,e){return m.call(t,e)},E=function(t){return Object.prototype.toString.call(t).replace(/^\[\w*\s|\]/g,"")},x=function(t){var e=q();return"string"==typeof t&&(t=q(t)),!t.isBrief&&t.length?h.apply(e,t):e.push(t),e},O=function(t){var e,n,r,l,i=t.target,s=o[t.type];if(i!==document)for(e=0;e<s.length;e++)n=s[e],r=n.element,l=n.delegatedTo,A(i,l)&&r.contains(i)&&n.callback.call(r,t)},w=function(t){for(var e=i[t.type],n=l[t.type],r=e.indexOf(t.target);-1!==r;)n[r].call(e[r],t),r=e.indexOf(t.target,r+1)},B=function(){var t=x(arguments[0]),e=a.call(arguments,1);q.prototype.on.apply(t,e)},S=function(){var t=x(arguments[0]),e=a.call(arguments,1);q.prototype.onAll.apply(t,e)},j=function(){var t=x(arguments[0]),e=a.call(arguments,1);q.prototype.off.apply(t,e)},k=function(){var t=x(arguments[0]),e=a.call(arguments,1);q.prototype.offAll.apply(t,e)},M=function(){var t=x(arguments[0]),e=a.call(arguments,1);q.prototype.once.apply(t,e)},T=function(){var t=x(arguments[0]),e=a.call(arguments,1);q.prototype.onceAll.apply(t,e)},q=function(t,e){return new q.prototype.create(t,e)};return q.prototype={length:0,isBrief:!0,splice:function(){return p.apply(this,a.call(arguments,0)),this},push:function(){var t,e,n=a.call(arguments,0);for(e=0;e<n.length;e++)t=n[e],t.isBrief?h.apply(this,t.toArray()):t.length?h.apply(this,t):h.call(this,t);return this},pop:function(){return g.apply(this),this},toArray:function(){return a.call(this,0)},empty:function(){for(;this.length>0;)this.pop();return this},filter:function(t){var e,n;return"string"==typeof t&&(n=t,t=function(t){return A(t,n)}),e=y.call(this,t),e.selector=n?n:this.selector,e},indexOf:function(t){var e;for(e=0;e<this.length;e++)if(A(this[e],t))return e;return-1},get:function(t){return this[t]},find:function(t){var e,n=q();for(e=0;e<this.length;e++)h.apply(n,a.call(this.get(e).querySelectorAll(t),0));return n.selector=this.selctor,n},getChildren:function(){var t,e=q();for(t=0;t<this.length;t++)h.apply(e,this[t].children);return e},forEach:function(t){return u.call(this,t),this},map:function(t){return f.call(this,t)},getOffsets:function(){return this.length&&null!=this[0]?this.map(function(t){var e=t.getBoundingClientRect();return{top:e.top,left:e.left}}):null},on:function(t,e,n,r){var s,c,a=e,u=this;for("boolean"==typeof n&&(r=n,n=void 0),!n&&r&&(a=function(n){u.off(t,a),e.call(this,n)}),c=0;c<u.length;c++)s=u[c],n?(o[t]||(o[t]=[],document.addEventListener(t,O,!0)),o[t].push({element:s,delegatedTo:n,callback:e})):(i[t]||(i[t]=[],l[t]=[],document.addEventListener(t,w,!0)),i[t].push(s),l[t].push(a))},onAll:function(t,e,n,r){var o;for(o=0;o<t.length;o++)this.on(t[o],e,n,r)},off:function(t,e,n){var r,s,c,a,u,f,p,h=this;for(p=0;p<h.length;p++)if(s=h[p],n){for(a=o[t],c=a.length;c--;)u=a[c],u.element===s&&u.delegatedTo===n&&u.callback===e&&a.splice(c,1);a.length||document.removeEventListener(t,O,!0)}else for(a=l[t],r=i[t],f=a.indexOf(e);-1!==f;)s===r[f]&&(r.splice(f,1),a.splice(f,1),f--),f=a.indexOf(e,f+1)},offAll:function(t,e,n){var r;for(r=0;r<t.length;r++)this.off(t[r],e,n)},once:function(){var t=a.call(arguments,0);return t.push(!0),q.prototype.on.apply(this,t)},onceAll:function(){var t=a.call(arguments,0);return t.push(!0),q.prototype.onAll.apply(this,t)}},r=q.prototype.create=function(e,n){var r;return(e||n)&&(("string"==typeof n||!n&&e)&&(this.selector=n||e,r=d.test(this.selector)?[t.getElementById(this.selector.substring(1))]:v.test(this.selector)?t.getElementsByClassName(this.selector.substring(1)):b.test(this.selector)?t.getElementsByTagName(this.selector):t.querySelectorAll(this.selector),r.length&&null!=r[0]&&h.apply(this,a.call(r,0))),this.selector===n?this.find(e):n&&n.isBrief?h.apply(this,n.find(e)):"object"==typeof n&&(h.apply(this,n.length?n:[n]),this.find(e))),this},r.prototype=q.prototype,q.extend=function(){var t,e,n,r,o,l,i,s,c,a=arguments[0]||{},u=1,f=arguments.length,p=!1;for("boolean"==typeof a&&(p=a,a=arguments[1]||{},i=E(a),u=2),"object"!=typeof a&&"Function"!==i&&(a={});f>u;u++)if(t=arguments[u],null!=t){"string"==typeof t&&(t=t.split(""));for(e in t)n=a[e],s=E(n),r=t[e],c=E(r),a!==r&&(p&&r&&("Object"===c||(o="Array"===c))?(o?(o=!1,l=n&&"Array"===s?n:[]):l=n&&"Object"===s?n:{},a[e]=q.extend(p,l,r)):"undefined"!=typeof r&&(a[e]=r))}return a},q.on=B,q.onAll=S,q.off=j,q.offAll=k,q.once=M,q.onceAll=T,q}.bind(this,document,Element,Array));