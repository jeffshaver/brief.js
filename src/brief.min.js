/* brief.js | Copyright 2014 Jeffrey E. Shaver II | Released under the MIT license | https://github.com/jeffshaver/brief.js/blob/master/LICENSE */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=global.document?e():function(){throw new Error("brief requires a document to run")}:t.brief=e()}(this,function(t,e,n){"use strict";var r,o={},i={},l={},s=n.prototype,c=e.prototype,a=s.slice,f=s.splice,h=s.push,u=s.pop,p=s.filter,g=c.matchesSelector||c.msMatchesSelector||c.mozMatchesSelector||c.webkitMatchesSelector||c.oMatchesSelector,y=/^#[\w\d]+$/,d=/^\.[\w\d]+$/,m=/^[\w\d]+$/,v=function(t,e){return g.call(t,e)},b=function(t){return"string"==typeof t?t.split(" "):a.call(t,0)},E=function(t){var e=A();return"string"==typeof t&&(t=A(t)),!t.isBrief&&t.length?h.apply(e,t):e.push(t),e},B=function(t){var e,n,r,i,l=t.target,s=o[t.type];if(l!==document)for(e=0;e<s.length;e++)n=s[e],r=n.element,i=n.delegatedTo,v(l,i)&&r.contains(l)&&n.callback.call(this,t)},w=function(t){for(var e=l[t.type],n=i[t.type],r=e.indexOf(t.target);-1!==r;)n[r].call(this,t),r=e.indexOf(t.target,r+1)},x=function(){var t=E(arguments[0]),e=a.call(arguments,1);A.prototype.on.apply(t,e)},S=function(){var t=E(arguments[0]),e=a.call(arguments,1);A.prototype.off.apply(t,e)},O=function(){var t=E(arguments[0]),e=a.call(arguments,1);A.prototype.once.apply(t,e)},A=function(t,e){return new A.prototype.create(t,e)};return A.prototype={length:0,isBrief:!0,splice:function(){return f.apply(this,a.call(arguments,0)),this},push:function(){var t,e,n=a.call(arguments,0);for(e=0;e<n.length;e++)t=n[e],t.isBrief?h.apply(this,t.toArray()):t.length?h.apply(this,t):h.call(this,t);return this},pop:function(){return u.apply(this),this},toArray:function(){return a.call(this,0)},empty:function(){for(;this.length>0;)this.pop();return this},filter:function(t){var e,n;return"string"==typeof t&&(n=t,t=function(t){return v(t,n)}),e=p.call(this,t),e.selector=n?n:this.selector,e},indexOf:function(t){var e;for(e=0;e<this.length;e++)if(v(this[e],t))return e;return-1},get:function(t){return this[t]},find:function(t){var e,n=A();for(e=0;e<this.length;e++)h.apply(n,a.call(this.get(e).querySelectorAll(t),0));return n.selector=this.selctor,n},getChildren:function(){var t,e=A();for(t=0;t<this.length;t++)h.apply(e,this[t].children);return e},forEach:function(t){var e;for(e=0;e<this.length;e++)t(this[e],e,this);return this},getOffsets:function(){var t=[];return this.length&&null!=this[0]?(this.forEach(function(e){var n=e.getBoundingClientRect();t.push({top:n.top,left:n.left})}),1==t.length?t[0]:t):null},on:function(t,e,n,r){var s,c,a,f,h=e,u=this;for("boolean"==typeof n&&(r=n,n=void 0),t=b(t),!n&&r&&(h=function(n){u.off(t,h,!1),e.call(this,n)}),a=0;a<t.length;a++)for(c=t[a],f=0;f<u.length;f++)s=u[f],n?(o[c]||(o[c]=[],document.addEventListener(c,B,!0)),o[c].push({element:s,delegatedTo:n,callback:e})):(l[c]||(l[c]=[],i[c]=[],document.addEventListener(c,w,!0)),l[c].push(s),i[c].push(h))},off:function(t,e,n){var r,s,c,a,f,h,u,p,g,y=this;for(t=b(t),p=0;p<t.length;p++)for(g=0,r=t[p],g=0;g<y.length;g++)if(c=y[g],n){for(f=o[r],a=f.length;a--;)h=f[a],h.element===c&&h.delegatedTo===n&&h.callback===e&&f.splice(a,1);f.length||document.removeEventListener(r,B,!0)}else for(f=i[r],s=l[r],u=f.indexOf(e);-1!==u;)c===s[u]&&(s.splice(u,1),f.splice(u,1),u--),u=f.indexOf(e,u+1)},once:function(){var t=a.call(arguments,0);return t.push(!0),A.prototype.on.apply(this,t)}},r=A.prototype.create=function(e,n){var r;return(e||n)&&(("string"==typeof n||!n&&e)&&(this.selector=n||e,r=y.test(this.selector)?[t.getElementById(this.selector.substring(1))]:d.test(this.selector)?t.getElementsByClassName(this.selector.substring(1)):m.test(this.selector)?t.getElementsByTagName(this.selector):t.querySelectorAll(this.selector),r.length&&null!=r[0]&&h.apply(this,a.call(r,0))),this.selector===n?this.find(e):n&&n.isBrief?h.apply(this,n.find(e)):"object"==typeof n&&(h.apply(this,n.length?n:[n]),this.find(e))),this},r.prototype=A.prototype,A.on=x,A.off=S,A.once=O,A}.bind(this,document,Element,Array));