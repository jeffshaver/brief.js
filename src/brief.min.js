/* brief.js | Copyright 2014 Jeffrey E. Shaver II | Released under the MIT license | https://github.com/jeffshaver/brief.js/blob/master/LICENSE */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=global.document?e():function(){throw new Error("brief requires a document to run")}:t.brief=e()}(this,function(t,e,n){"use strict";var r,o={},i={},l={},a=n.prototype,s=e.prototype,p=a.slice,c=a.forEach,u=a.map,f=a.splice,h=a.push,g=a.pop,d=a.filter,y=s.matchesSelector||s.msMatchesSelector||s.mozMatchesSelector||s.webkitMatchesSelector||s.oMatchesSelector,m=/^#[\w\d]+$/,v=/^\.[\w\d]+$/,w=/^[\w\d]+$/,b=function(t,e){return y.call(t,e)},E=function(t){return Object.prototype.toString.call(t).replace(/^\[\w*\s|\]/g,"")},S=function(t){var e=L();return"String"!=E(t)&&(t=L(t)),!t.isBrief&&t.length?h.apply(e,t):e.push(t),e},A=function(t,e){var n,r,o,a=e.parentNode||window,s=l[t.type],p=i[t.type];if(e!==window)for(;void 0!==a&&!t.propagationStopped;){if(n=s.indexOf(a),e!==a&&-1!==n)for(r=p[n],o=0;o<r.length;o++)r[o].call(a,t);a=null!==a.parentNode?a.parentNode:window}},x=function(e){var n,r,i,l,a,s=o[e.type],p=new L.Event(e);if(n!==t)for(r=0;r<s.length;r++)for(n=e.target,i=s[r],l=i.element,a=i.delegatedTo;n!==t;)b(n,a)&&(l===window||l.contains(n)&&!p.propagationStopped)&&i.callback.call(n,p),n=n.parentNode},O=function(t){for(var e,n,r=l[t.type],o=i[t.type],a=new L.Event(t),s=a.target,p=r.indexOf(s);-1===p&&(s=s.parentNode?s.parentNode:window,p=r.indexOf(s),s!==window||-1!==p););if(-1!==p){for(n=o[p],e=0;e<n.length;e++)n[e].call(s,a);return void(a.propagationStopped||A(a,s))}},T=function(){var t=S(arguments[0]),e=p.call(arguments,1);L.prototype.on.apply(t,e)},B=function(){var t=S(arguments[0]),e=p.call(arguments,1);L.prototype.onAll.apply(t,e)},N=function(){var t=S(arguments[0]),e=p.call(arguments,1);L.prototype.off.apply(t,e)},j=function(){var t=S(arguments[0]),e=p.call(arguments,1);L.prototype.offAll.apply(t,e)},k=function(){var t=S(arguments[0]),e=p.call(arguments,1);L.prototype.once.apply(t,e)},P=function(){var t=S(arguments[0]),e=p.call(arguments,1);L.prototype.onceAll.apply(t,e)},L=function(t,e){return new L.prototype.create(t,e)};return L.prototype={length:0,isBrief:!0,splice:function(){return f.apply(this,arguments),this},push:function(){var t,e,n=p.call(arguments,0);for(e=0;e<n.length;e++)t=n[e],t.isBrief?h.apply(this,t.toArray()):t.length?h.apply(this,t):h.call(this,t);return this},pop:function(){return g.apply(this),this},toArray:function(){return p.call(this,0)},empty:function(){for(;this.length>0;)this.pop();return this},filter:function(t){var e,n;return"String"==E(t)&&(n=t,t=function(t){return b(t,n)}),e=d.call(this,t),e.selector=n?n:this.selector,e},indexOf:function(t){var e;for(e=0;e<this.length;e++)if(b(this[e],t))return e;return-1},get:function(t){if("Number"!=E(t))throw new TypeError("`index` must be a number");return this[t]},find:function(t){var e,n=L();if("String"!=E(t))throw new TypeError("selector must be a string");for(e=0;e<this.length;e++)h.apply(n,p.call(this.get(e).querySelectorAll(t),0));return n.selector=this.selctor,n},getChildren:function(){var t,e=L();for(t=0;t<this.length;t++)h.apply(e,this[t].children);return e},forEach:function(t){if("Function"!=E(t))throw new TypeError("callback must be a function");return c.call(this,t),this},map:function(t){return u.call(this,t)},getOffsets:function(){return this.length&&null!=this[0]?this.map(function(t){var e=t.getBoundingClientRect();return{top:e.top,left:e.left}}):null},on:function(e,n,r,a){var s,p,c=n,u=this;if("String"!=E(e))throw new TypeError("type must be a string");if("Function"!=E(n))throw new TypeError("callback must be a function");for("Boolaen"!=E(r)&&(a=r,r=void 0),!r&&a&&(c=function(t){u.off(e,c),n.call(this,t)}),p=0;p<u.length;p++)s=u[p],r?(o[e]||(o[e]=[],t.addEventListener(e,x,!0)),o[e].push({element:s,delegatedTo:r,callback:n})):(l[e]||(l[e]=[],i[e]=[],t.addEventListener(e,O,!0)),-1===l[e].indexOf(s)&&(l[e].push(s),i[e].push([])),i[e][l[e].indexOf(s)].push(c))},onAll:function(t,e,n,r){var o;for(o=0;o<t.length;o++)this.on(t[o],e,n,r)},off:function(e,n,r){var a,s,p,c,u,f,h,g,d,y=this;for(g=0;g<y.length;g++)if(s=y[g],r){for(c=o[e],p=c.length;p--;)f=c[p],f.element===s&&f.delegatedTo===r&&f.callback===n&&c.splice(p,1);c.length||t.removeEventListener(e,x,!0)}else{for(c=i[e],a=l[e],h=a.indexOf(s),u=c[h],d=0;d<u.length;d++)u[d]===n&&u.splice(d,1);0===u.length&&(a.splice(h,1),c.splice(h,1)),0===a.length&&t.removeEventListener(e,O,!0)}},offAll:function(t,e,n){var r;for(r=0;r<t.length;r++)this.off(t[r],e,n)},once:function(){var t=p.call(arguments,0);return t.push(!0),L.prototype.on.apply(this,t)},onceAll:function(){var t=p.call(arguments,0);return t.push(!0),L.prototype.onAll.apply(this,t)}},r=L.prototype.create=function(e,n){var r;return(e||n)&&(("String"==E(n)||!n&&e)&&(this.selector=n||e,r=m.test(this.selector)?[t.getElementById(this.selector.substring(1))]:v.test(this.selector)?t.getElementsByClassName(this.selector.substring(1)):w.test(this.selector)?t.getElementsByTagName(this.selector):t.querySelectorAll(this.selector),r.length&&null!=r[0]&&h.apply(this,p.call(r,0))),this.selector===n?this.find(e):n&&n.isBrief?h.apply(this,n.find(e)):"object"==E(n)&&(h.apply(this,n.length?n:[n]),this.find(e))),this},r.prototype=L.prototype,L.Event=function(t){this.originalEvent=t,this.type=t.type,this.defaultPrevented=t.defaultPrevented,this.propagationStopped=!1,this.timeStamp=t.timeStamp,this.currentTarget=t.currentTarget,this.target=t.target,this.srcElement=t.srcElement},L.Event.prototype={preventDefault:function(){this.defaultPrevented=!0,this.originalEvent.preventDefault()},stopPropagation:function(){this.propagationStopped=!0,this.originalEvent.stopPropagation()}},L.extend=function(){var t,e,n,r,o,i,l,a,s,p=arguments[0]||{},c=1,u=arguments.length,f=!1;for("boolean"==typeof p&&(f=p,p=arguments[1]||{},l=E(p),c=2),"object"!=typeof p&&"Function"!==l&&(p={});u>c;c++)if(t=arguments[c],null!=t){"string"==typeof t&&(t=t.split(""));for(e in t)n=p[e],a=E(n),r=t[e],s=E(r),p!==r&&(f&&r&&("Object"===s||(o="Array"===s))?(o?(o=!1,i=n&&"Array"===a?n:[]):i=n&&"Object"===a?n:{},p[e]=L.extend(f,i,r)):"undefined"!=typeof r&&(p[e]=r))}return p},L.on=T,L.onAll=B,L.off=N,L.offAll=j,L.once=k,L.onceAll=P,L}.bind(this,document,Element,Array));