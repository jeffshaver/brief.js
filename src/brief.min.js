/* brief.js | Copyright 2014 Jeffrey E. Shaver II | Released under the MIT license | https://github.com/jeffshaver/brief.js/blob/master/LICENSE */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.brief=e()}(this,function(){"use strict";var t,e=document,n=Element,r=Array,i={},o={},s={},l=r.prototype,a=n.prototype,c=l.slice,h=l.forEach,f=l.map,p=l.splice,u=l.push,g=l.filter,d=a.matchesSelector||a.msMatchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.oMatchesSelector,y=/^#[\w\d]+$/,m=/^\.[\w\d]+$/,v=/^[\w\d]+$/,w=function(t,e){return d.call(t,e)},E=function(t){return Object.prototype.toString.call(t).replace(/^\[\w*\s|\]/g,"")},b=function(t){var e=O();return"String"==E(t)&&(t=O(t)),console.log(t),e.add(!t.isBrief&&t.length?t:t),e},S=function(t,e){var n,r,i,l=e.parentNode||window,a=s[t.type],c=o[t.type];if(e!==window)for(;void 0!==l&&!t.propagationStopped;){if(n=a.indexOf(l),e!==l&&-1!==n)for(r=c[n],i=0;i<r.length;i++)r[i].call(l,t);l=null!==l.parentNode?l.parentNode:window}},A=function(t,e){e!==!1&&t.stack.push(t.toArray())},T=function(t,n){var r,o,s,l,a=new O.Event(t),c=i[a.type];if(n!==e)for(r=0;r<c.length;r++)for(n=a.target,o=c[r],s=o.element,l=o.delegatedTo;n!==e;)w(n,l)&&(s===window||s.contains(n)&&!a.propagationStopped)&&o.callback.call(n,a),n=n.parentNode},x=function(t,e){var n,r,i=new O.Event(t,e),l=s[i.type],a=o[i.type],c=l.indexOf(i.target);for(e=i.target;-1===c&&!i.isArtificial&&(e=e.parentNode?e.parentNode:window,c=l.indexOf(e),e!==window||-1!==c););if(-1!==c){for(r=a[c],n=0;n<r.length;n++)r[n].call(e,i);return void(i.propagationStopped||S(i,e))}},O=function(t,e){return new O.prototype.create(t,e)};return O.prototype={length:0,isBrief:!0,splice:function(){return p.apply(this,arguments),this},stack:[],add:function(t){var e,n,r=c.call(arguments,t!==!1?0:1);for(A(this,t),n=0;n<r.length;n++)e=r[n],e.isBrief?u.apply(this,e.toArray()):e.length?u.apply(this,e):u.call(this,e);return this},remove:function(t){var e=c.call(arguments,t!==!1?0:1);return A(this,t),void 0==e[0]&&(e[0]=this.length-1),void 0==e[1]&&(e[1]=1),this.splice(e[0],e[1]),this},revert:function(){return 0===this.stack.length?this:this.empty(!1).add(!1,this.stack.pop())},toArray:function(){return c.call(this,0)},empty:function(t){for(;this.length>0;)this.remove(t);return this},filter:function(t,e){var n,r;return A(this,e),"String"==E(t)&&(r=t,t=function(t){return w(t,r)}),n=g.call(this.toArray(),t),this.empty(!1).add(!1,n),this.selector=r||this.selector,this},indexOf:function(t){var e;for(e=0;e<this.length;e++)if(w(this[e],t))return e;return-1},get:function(t){if("Number"!=E(t))throw new TypeError("`index` must be a number");return this[t]},find:function(t,e){var n,r=[];if("String"!=E(t))throw new TypeError("selector must be a string");for(A(this,e),console.log("this",this),n=0;n<this.length;n++)u.apply(r,c.call(this.get(n).querySelectorAll(t),0));return console.log("elements",r),this.empty(!1).add(!1,r),this.selector=t,this},getChildren:function(t){var e,n=[];for(A(this,t),e=0;e<this.length;e++)u.apply(n,this[e].children);return this.empty(!1).add(!1,n),this},forEach:function(t){if("Function"!=E(t))throw new TypeError("callback must be a function");return h.call(this,t),this},map:function(t){return f.call(this,t)},getOffsets:function(){return this.length&&null!=this[0]?this.map(function(t){var e=t.getBoundingClientRect();return{top:e.top,left:e.left}}):null},on:function(t,n,r,l){var a,c,h=n,f=this;if("String"!=E(t))throw new TypeError("type must be a string");if("Function"!=E(n))throw new TypeError("callback must be a function");for("Boolaen"!=E(r)&&(l=r,r=void 0),!r&&l&&(h=function(e){f.off(t,h),n.call(this,e)}),c=0;c<f.length;c++)a=f[c],r?(i[t]||(i[t]=[],e.addEventListener(t,T,!0)),i[t].push({element:a,delegatedTo:r,callback:n})):(s[t]||(s[t]=[],o[t]=[],e.addEventListener(t,x,!0)),-1===s[t].indexOf(a)&&(s[t].push(a),o[t].push([])),o[t][s[t].indexOf(a)].push(h))},onAll:function(t,e,n,r){var i;for(i=0;i<t.length;i++)this.on(t[i],e,n,r)},off:function(t,n,r){var l,a,c,h,f,p,u,g,d,y=this;for(g=0;g<y.length;g++)if(a=y[g],r){for(h=i[t],c=h.length;c--;)p=h[c],p.element===a&&p.delegatedTo===r&&p.callback===n&&h.splice(c,1);h.length||e.removeEventListener(t,T,!0)}else{for(h=o[t],l=s[t],u=l.indexOf(a),f=h[u],d=0;d<f.length;d++)f[d]===n&&f.splice(d,1);0===f.length&&(l.splice(u,1),h.splice(u,1)),0===l.length&&e.removeEventListener(t,x,!0)}},offAll:function(t,e,n){var r;for(r=0;r<t.length;r++)this.off(t[r],e,n)},once:function(){var t=c.call(arguments,0);return t.push(!0),O.prototype.on.apply(this,t)},onceAll:function(){var t=c.call(arguments,0);return t.push(!0),O.prototype.onAll.apply(this,t)},trigger:function(t){this.forEach(function(e){o[t]&&o[t].length>0&&x(t,e),i[t]&&i[t].length>0})}},t=O.prototype.create=function(t,n){var r;return(t||n)&&(("String"==E(n)||!n&&t)&&(this.selector=n||t,r=y.test(this.selector)?[e.getElementById(this.selector.substring(1))]:m.test(this.selector)?e.getElementsByClassName(this.selector.substring(1)):v.test(this.selector)?e.getElementsByTagName(this.selector):e.querySelectorAll(this.selector),r.length&&null!=r[0]&&this.add(!1,c.call(r,0))),this.selector===n?this.find(t,!1):n&&n.isBrief?this.add(!1,n.find(t)):"object"==E(n)&&(this.add(!1,n.length?n:[n]),this.find(t,!1))),this},t.prototype=O.prototype,O.Event=function(t,e){e?(this.type=t,this.defaultPrevented=!1,this.propagationStopped=!0,this.timeStamp=(new Date).getTime(),this.currentTarget=e,this.target=e,this.srcElement=e,this.isArtificial=!0):(this.originalEvent=t,this.type=t.type,this.defaultPrevented=t.defaultPrevented,this.propagationStopped=!1,this.timeStamp=t.timeStamp,this.currentTarget=t.currentTarget,this.target=t.target,this.srcElement=t.srcElement,this.isArtificial=!1)},O.Event.prototype={preventDefault:function(){this.defaultPrevented=!0,this.originalEvent.preventDefault()},stopPropagation:function(){this.propagationStopped=!0,this.originalEvent.stopPropagation()}},O.extend=function(){var t,e,n,r,i,o,s,l,a,c=arguments[0]||{},h=1,f=arguments.length,p=!1;for("boolean"==typeof c&&(p=c,c=arguments[1]||{},s=E(c),h=2),"object"!=typeof c&&"Function"!==s&&(c={});f>h;h++)if(t=arguments[h],null!=t){"string"==typeof t&&(t=t.split(""));for(e in t)n=c[e],l=E(n),r=t[e],a=E(r),c!==r&&(p&&r&&("Object"===a||(i="Array"===a))?(i?(i=!1,o=n&&"Array"===l?n:[]):o=n&&"Object"===l?n:{},c[e]=O.extend(p,o,r)):"undefined"!=typeof r&&(c[e]=r))}return c},["on","onAll","off","offAll","once","onceAll","trigger"].forEach(function(t){O[t]=function(){var e=b(arguments[0]),n=c.call(arguments,1);O.prototype[t].apply(e,n)}}),O});