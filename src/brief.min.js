/* brief.js | Copyright 2014 Jeffrey E. Shaver II | Released under the MIT license | https://github.com/jeffshaver/brief.js/blob/master/LICENSE */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.brief=e(document,Element,Array)}(this,function(t,e,n){"use strict";var r,i=[],o=n.prototype,s=e.prototype,l=o.slice,c=o.splice,a=o.push,f=o.pop,h=o.filter,p=s.matchesSelector||s.msMatchesSelector||s.mozMatchesSelector||s.webkitMatchesSelector||s.oMatchesSelector,u=/^#[\w\d]*$/,g=/^\.[\w\d]*$/,y=/^[\w\d]*$/,d=function(t,e){return p.call(t,e)},m=function(t){var e;return"string"==typeof t&&(e=t.split(" ")),e||l.call(t,0)},v=function(t){var e=S();return"string"==typeof t&&(t=S(t)),!t.isBrief&&t.length?a.apply(e,t):e.push(t),e},_=function(t,e,n,r){var o=e,s=this;return!n&&r&&(o=function(n){s.off(t,o,!1),e.call(this,n)}),n&&(o=i[e.__briefId]||function(t){d(t.srcElement,n)&&(r&&s.off(type,e,n),e.call(this,t))}),o},b=function(){var t=v(arguments[0]),e=l.call(arguments,1);S.prototype.on.apply(t,e)},E=function(){var t=v(arguments[0]),e=l.call(arguments,1);S.prototype.off.apply(t,e)},B=function(){var t=v(arguments[0]),e=l.call(arguments,1);S.prototype.once.apply(t,e)},S=function(t,e){return new S.prototype.create(t,e)};return S.prototype={length:0,isBrief:!0,splice:function(){return c.apply(this,l.call(arguments,0)),this},push:function(){for(var t,e=l.call(arguments,0),n=0,r=e.length;r>n;n++)t=e[n],t.isBrief?a.apply(this,t.toArray()):t.length?a.apply(this,t):a.call(this,t);return this},pop:function(){return f.apply(this),this},toArray:function(){return l.call(this,0)},empty:function(){for(;this.length>0;)this.pop();return this},filter:function(t){var e=h.call(this,function(e){return d(e,t)});return e.selector=this.selector,e},indexOf:function(t){for(var e=0;e<this.length;e++)if(d(this[e],t))return e;return-1},get:function(t){return this[t]},find:function(t){for(var e=S(),n=this.length,r=0;n>r;r++)a.apply(e,l.call(this.get(r).querySelectorAll(t),0));return e.selector=this.selctor,e},getChildren:function(){for(var t=S(),e=0;e<this.length;e++)a.apply(t,this[e].children);return t},forEach:function(t){for(var e=0,n=this.length;n>e;e++)t(this[e],e,this);return this},getOffsets:function(){var t=[];return this.length&&null!=this[0]?(this.forEach(function(e){var n=e.getBoundingClientRect();t.push({top:n.top,left:n.left})}),1==t.length?t[0]:t):null},on:function(t,e,n,r){var o,s,l,c,a,f=e,h=this,p=0;for("boolean"==typeof n&&(r=n,n=void 0),t=m(t),f=_.call(this,t,e,n,r),c=t.length;c>p;p++)for(l=0,s=t[p],a=h.length;a>l;l++)o=h[l],n?(void 0===e.__briefId&&(e.__briefId=i.length,f._instances=[],f._originalCallback=e,i[e.__briefId]=f),f._instances.push({element:o,type:s,delegatedTo:n}),o.addEventListener(s,f,!0)):o.addEventListener(s,f,!1)},off:function(t,e,n){var r,o,s,l,c,a,f,h,p=this,u=0;for(t=m(t),f=t.length;f>u;u++)for(s=0,r=t[u],h=p.length;h>s;s++)if(o=p[s],n)for(c=i[e.__briefId],o.removeEventListener(r,c,!0),a=c._instances,l=a.length;l--;)a[l].element==o&&a[l].type==r&&a[l].delegatedTo==n&&c._instances.splice(l,1);else o.removeEventListener(r,e,!1)},once:function(){var t=l.call(arguments,0);return t.push(!0),S.prototype.on.apply(this,t)}},r=S.prototype.create=function(e,n){var r;return(e||n)&&(("string"==typeof n||!n&&e)&&(this.selector=n||e,r=u.test(this.selector)?[t.getElementById(this.selector.substring(1))]:g.test(this.selector)?t.getElementsByClassName(this.selector.substring(1)):y.test(this.selector)?t.getElementsByTagName(this.selector):t.querySelectorAll(this.selector),r.length&&null!=r[0]&&a.apply(this,l.call(r,0))),this.selector==n?this.find(e):n&&n.isBrief?a.apply(this,n.find(e)):"object"==typeof n&&(a.apply(this,n.length?n:[n]),this.find(e))),this},r.prototype=S.prototype,S.on=b,S.off=E,S.once=B,S}.bind(this,document,Element,Array));